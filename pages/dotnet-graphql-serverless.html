<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How you can build a Serverless API using GraphQL .Net Core, C# and VS Code</title>
    <meta name="description" content="[object Object]">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.1f33e7c2.css" as="style"><link rel="preload" href="/assets/js/app.95c997f3.js" as="script"><link rel="preload" href="/assets/js/9.454b5262.js" as="script"><link rel="preload" href="/assets/js/4.eac68367.js" as="script"><link rel="preload" href="/assets/js/151.8267fcff.js" as="script"><link rel="prefetch" href="/assets/js/1.36663999.js"><link rel="prefetch" href="/assets/js/10.6aaebcfe.js"><link rel="prefetch" href="/assets/js/100.f7776fae.js"><link rel="prefetch" href="/assets/js/101.83c4ff25.js"><link rel="prefetch" href="/assets/js/102.d3a51c53.js"><link rel="prefetch" href="/assets/js/103.005176e9.js"><link rel="prefetch" href="/assets/js/104.ad6ac0a2.js"><link rel="prefetch" href="/assets/js/105.1c2918c1.js"><link rel="prefetch" href="/assets/js/106.84577e76.js"><link rel="prefetch" href="/assets/js/107.39206cda.js"><link rel="prefetch" href="/assets/js/108.b717e412.js"><link rel="prefetch" href="/assets/js/109.a0275c41.js"><link rel="prefetch" href="/assets/js/11.e44a9c79.js"><link rel="prefetch" href="/assets/js/110.acd428a7.js"><link rel="prefetch" href="/assets/js/111.85c1f355.js"><link rel="prefetch" href="/assets/js/112.62bab5e5.js"><link rel="prefetch" href="/assets/js/113.30083b82.js"><link rel="prefetch" href="/assets/js/114.2dcc568f.js"><link rel="prefetch" href="/assets/js/115.2ee55351.js"><link rel="prefetch" href="/assets/js/116.44cdb765.js"><link rel="prefetch" href="/assets/js/117.f22ffed2.js"><link rel="prefetch" href="/assets/js/118.fda8edf7.js"><link rel="prefetch" href="/assets/js/119.1ea9eae7.js"><link rel="prefetch" href="/assets/js/12.02e6e552.js"><link rel="prefetch" href="/assets/js/120.cf073939.js"><link rel="prefetch" href="/assets/js/121.d06bb8bc.js"><link rel="prefetch" href="/assets/js/122.533a0953.js"><link rel="prefetch" href="/assets/js/123.382bf140.js"><link rel="prefetch" href="/assets/js/124.1e416617.js"><link rel="prefetch" href="/assets/js/125.88e1d9ef.js"><link rel="prefetch" href="/assets/js/126.ac7f0ed9.js"><link rel="prefetch" href="/assets/js/127.2452b31c.js"><link rel="prefetch" href="/assets/js/128.4387dd5e.js"><link rel="prefetch" href="/assets/js/129.57ea763a.js"><link rel="prefetch" href="/assets/js/13.215ad842.js"><link rel="prefetch" href="/assets/js/130.db7a97a9.js"><link rel="prefetch" href="/assets/js/131.cb028185.js"><link rel="prefetch" href="/assets/js/132.1f53aba9.js"><link rel="prefetch" href="/assets/js/133.3e4f88da.js"><link rel="prefetch" href="/assets/js/134.78b60412.js"><link rel="prefetch" href="/assets/js/135.67d56f81.js"><link rel="prefetch" href="/assets/js/136.5f5c962b.js"><link rel="prefetch" href="/assets/js/137.a4bdc628.js"><link rel="prefetch" href="/assets/js/138.9e4dca1e.js"><link rel="prefetch" href="/assets/js/139.ff87d106.js"><link rel="prefetch" href="/assets/js/14.12340cee.js"><link rel="prefetch" href="/assets/js/140.345c5f56.js"><link rel="prefetch" href="/assets/js/141.7ca86301.js"><link rel="prefetch" href="/assets/js/142.dd05b794.js"><link rel="prefetch" href="/assets/js/143.c0950d2f.js"><link rel="prefetch" href="/assets/js/144.e36983d5.js"><link rel="prefetch" href="/assets/js/145.0fe3cd59.js"><link rel="prefetch" href="/assets/js/146.cabf0d13.js"><link rel="prefetch" href="/assets/js/147.41e37bae.js"><link rel="prefetch" href="/assets/js/148.1aff1942.js"><link rel="prefetch" href="/assets/js/149.43ddd51d.js"><link rel="prefetch" href="/assets/js/15.34674cd6.js"><link rel="prefetch" href="/assets/js/150.2dcc7e56.js"><link rel="prefetch" href="/assets/js/152.19aac962.js"><link rel="prefetch" href="/assets/js/153.90c26683.js"><link rel="prefetch" href="/assets/js/154.11f5eee4.js"><link rel="prefetch" href="/assets/js/155.fcfefbc5.js"><link rel="prefetch" href="/assets/js/156.8d837db5.js"><link rel="prefetch" href="/assets/js/157.347109ba.js"><link rel="prefetch" href="/assets/js/158.ad5d15c7.js"><link rel="prefetch" href="/assets/js/159.fa03b2bf.js"><link rel="prefetch" href="/assets/js/16.119e91d4.js"><link rel="prefetch" href="/assets/js/160.77c40a45.js"><link rel="prefetch" href="/assets/js/161.bc50d184.js"><link rel="prefetch" href="/assets/js/162.6eb99077.js"><link rel="prefetch" href="/assets/js/163.7daf038b.js"><link rel="prefetch" href="/assets/js/164.29a5a4a0.js"><link rel="prefetch" href="/assets/js/165.2158f290.js"><link rel="prefetch" href="/assets/js/166.7edeee8d.js"><link rel="prefetch" href="/assets/js/167.7fba076e.js"><link rel="prefetch" href="/assets/js/168.aee92853.js"><link rel="prefetch" href="/assets/js/169.f1c69f9e.js"><link rel="prefetch" href="/assets/js/17.780050f1.js"><link rel="prefetch" href="/assets/js/170.c3db9ca3.js"><link rel="prefetch" href="/assets/js/171.39f16573.js"><link rel="prefetch" href="/assets/js/172.854c26f8.js"><link rel="prefetch" href="/assets/js/173.7ac7eb22.js"><link rel="prefetch" href="/assets/js/174.8b371e6b.js"><link rel="prefetch" href="/assets/js/175.2ea22ad4.js"><link rel="prefetch" href="/assets/js/176.342164c7.js"><link rel="prefetch" href="/assets/js/177.ca5f8796.js"><link rel="prefetch" href="/assets/js/178.b191bdb8.js"><link rel="prefetch" href="/assets/js/179.976e6278.js"><link rel="prefetch" href="/assets/js/18.053933da.js"><link rel="prefetch" href="/assets/js/180.aedfb4ca.js"><link rel="prefetch" href="/assets/js/181.e5449166.js"><link rel="prefetch" href="/assets/js/182.903ca4cf.js"><link rel="prefetch" href="/assets/js/183.f2506256.js"><link rel="prefetch" href="/assets/js/184.07b6cfc7.js"><link rel="prefetch" href="/assets/js/185.e92dcf96.js"><link rel="prefetch" href="/assets/js/186.e17f8c1c.js"><link rel="prefetch" href="/assets/js/187.99170016.js"><link rel="prefetch" href="/assets/js/188.90581d2f.js"><link rel="prefetch" href="/assets/js/189.0e1a3abe.js"><link rel="prefetch" href="/assets/js/19.910fc8d0.js"><link rel="prefetch" href="/assets/js/190.41b9ccd3.js"><link rel="prefetch" href="/assets/js/191.4add1d16.js"><link rel="prefetch" href="/assets/js/192.b2cb6399.js"><link rel="prefetch" href="/assets/js/193.b4035cf0.js"><link rel="prefetch" href="/assets/js/194.aca90bf6.js"><link rel="prefetch" href="/assets/js/195.6fa13ccd.js"><link rel="prefetch" href="/assets/js/196.269c7fdd.js"><link rel="prefetch" href="/assets/js/197.9c2db328.js"><link rel="prefetch" href="/assets/js/198.9e158af1.js"><link rel="prefetch" href="/assets/js/199.72ae3d2d.js"><link rel="prefetch" href="/assets/js/20.e8c8408a.js"><link rel="prefetch" href="/assets/js/200.2b7692a5.js"><link rel="prefetch" href="/assets/js/201.47c19701.js"><link rel="prefetch" href="/assets/js/202.c234220d.js"><link rel="prefetch" href="/assets/js/203.238a75d6.js"><link rel="prefetch" href="/assets/js/204.71c0bf86.js"><link rel="prefetch" href="/assets/js/21.287aba19.js"><link rel="prefetch" href="/assets/js/22.f4b7a74b.js"><link rel="prefetch" href="/assets/js/23.fa51555f.js"><link rel="prefetch" href="/assets/js/24.cd8d9d78.js"><link rel="prefetch" href="/assets/js/25.a9fce161.js"><link rel="prefetch" href="/assets/js/26.e3067144.js"><link rel="prefetch" href="/assets/js/27.0610f28c.js"><link rel="prefetch" href="/assets/js/28.f1b496e3.js"><link rel="prefetch" href="/assets/js/29.ef58c202.js"><link rel="prefetch" href="/assets/js/3.970a66a4.js"><link rel="prefetch" href="/assets/js/30.ae297928.js"><link rel="prefetch" href="/assets/js/31.4fd0d93b.js"><link rel="prefetch" href="/assets/js/32.07e772d9.js"><link rel="prefetch" href="/assets/js/33.8045f864.js"><link rel="prefetch" href="/assets/js/34.295422ff.js"><link rel="prefetch" href="/assets/js/35.39e60c42.js"><link rel="prefetch" href="/assets/js/36.fddd48a5.js"><link rel="prefetch" href="/assets/js/37.367a54b5.js"><link rel="prefetch" href="/assets/js/38.a612debc.js"><link rel="prefetch" href="/assets/js/39.94b70e03.js"><link rel="prefetch" href="/assets/js/40.b4ed34c8.js"><link rel="prefetch" href="/assets/js/41.390ffe47.js"><link rel="prefetch" href="/assets/js/42.55e09873.js"><link rel="prefetch" href="/assets/js/43.8065223a.js"><link rel="prefetch" href="/assets/js/44.786fa232.js"><link rel="prefetch" href="/assets/js/45.89a5cd81.js"><link rel="prefetch" href="/assets/js/46.74ac226f.js"><link rel="prefetch" href="/assets/js/47.3bc4cde3.js"><link rel="prefetch" href="/assets/js/48.4ee9fba2.js"><link rel="prefetch" href="/assets/js/49.02a5f0f0.js"><link rel="prefetch" href="/assets/js/5.d1da013e.js"><link rel="prefetch" href="/assets/js/50.5bffa682.js"><link rel="prefetch" href="/assets/js/51.51580cbc.js"><link rel="prefetch" href="/assets/js/52.e69de275.js"><link rel="prefetch" href="/assets/js/53.326a7442.js"><link rel="prefetch" href="/assets/js/54.222addc9.js"><link rel="prefetch" href="/assets/js/55.bd4d5a38.js"><link rel="prefetch" href="/assets/js/56.e14027f4.js"><link rel="prefetch" href="/assets/js/57.949f3da5.js"><link rel="prefetch" href="/assets/js/58.f45aeb0d.js"><link rel="prefetch" href="/assets/js/59.a537c130.js"><link rel="prefetch" href="/assets/js/6.9bdf2d86.js"><link rel="prefetch" href="/assets/js/60.17850c9d.js"><link rel="prefetch" href="/assets/js/61.a9f91faa.js"><link rel="prefetch" href="/assets/js/62.24f5a40d.js"><link rel="prefetch" href="/assets/js/63.60a38d5b.js"><link rel="prefetch" href="/assets/js/64.ecda83e6.js"><link rel="prefetch" href="/assets/js/65.5ac936d7.js"><link rel="prefetch" href="/assets/js/66.ae14e9b3.js"><link rel="prefetch" href="/assets/js/67.6f7c9f8c.js"><link rel="prefetch" href="/assets/js/68.006a7e36.js"><link rel="prefetch" href="/assets/js/69.9d3a3878.js"><link rel="prefetch" href="/assets/js/7.9ac2367b.js"><link rel="prefetch" href="/assets/js/70.4a3f6622.js"><link rel="prefetch" href="/assets/js/71.6d7fab1a.js"><link rel="prefetch" href="/assets/js/72.fab91def.js"><link rel="prefetch" href="/assets/js/73.d791feee.js"><link rel="prefetch" href="/assets/js/74.2801f4e5.js"><link rel="prefetch" href="/assets/js/75.981b86e2.js"><link rel="prefetch" href="/assets/js/76.6241dd05.js"><link rel="prefetch" href="/assets/js/77.da0cc43e.js"><link rel="prefetch" href="/assets/js/78.bf5853c2.js"><link rel="prefetch" href="/assets/js/79.112a39ee.js"><link rel="prefetch" href="/assets/js/8.6b13a443.js"><link rel="prefetch" href="/assets/js/80.f2ed7194.js"><link rel="prefetch" href="/assets/js/81.4b4b8b2f.js"><link rel="prefetch" href="/assets/js/82.65bb49d8.js"><link rel="prefetch" href="/assets/js/83.80cc0629.js"><link rel="prefetch" href="/assets/js/84.f8c4a382.js"><link rel="prefetch" href="/assets/js/85.09c8c91b.js"><link rel="prefetch" href="/assets/js/86.1ff26044.js"><link rel="prefetch" href="/assets/js/87.79d46ddd.js"><link rel="prefetch" href="/assets/js/88.d7051ae9.js"><link rel="prefetch" href="/assets/js/89.ceed231e.js"><link rel="prefetch" href="/assets/js/90.cb5b9f7e.js"><link rel="prefetch" href="/assets/js/91.4c76179c.js"><link rel="prefetch" href="/assets/js/92.f68b9b5c.js"><link rel="prefetch" href="/assets/js/93.f9f451c7.js"><link rel="prefetch" href="/assets/js/94.38528942.js"><link rel="prefetch" href="/assets/js/95.41439023.js"><link rel="prefetch" href="/assets/js/96.bff3c86e.js"><link rel="prefetch" href="/assets/js/97.b6ad2632.js"><link rel="prefetch" href="/assets/js/98.9157217b.js"><link rel="prefetch" href="/assets/js/99.9fedc5bd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1f33e7c2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>How you can build a Serverless API using GraphQL .Net Core, C# and VS Code</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/dotnet-graphql-serverless.html#resources" class="sidebar-link">Resources</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/dotnet-graphql-serverless.html#create-a-serverless-function-app" class="sidebar-link">Create a Serverless function app</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#why-serverless" class="sidebar-link">Why Serverless?</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#why-serverless-with-graphql" class="sidebar-link">Why Serverless with GraphQL?</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#prerequisits" class="sidebar-link">Prerequisits</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#scaffold" class="sidebar-link">Scaffold</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#test-it-out" class="sidebar-link">Test it out</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#adding-a-graphql-schema" class="sidebar-link">Adding a GraphQL schema</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#adding-resolvers" class="sidebar-link">Adding resolvers</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#test-it-all-out" class="sidebar-link">Test it all out</a></li></ul></li><li><a href="/pages/dotnet-graphql-serverless.html#bonus-calling-other-endpoints" class="sidebar-link">Bonus - calling other endpoints</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#http-request" class="sidebar-link">HTTP Request</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#add-resolver-method" class="sidebar-link">Add resolver method</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#update-our-schema-with-the-new-type" class="sidebar-link">Update our schema with the new type</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-graphql-serverless.html#testing-it-out" class="sidebar-link">Testing it out</a></li></ul></li><li><a href="/pages/dotnet-graphql-serverless.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="how-you-can-build-a-serverless-api-using-graphql-net-core-c-and-vs-code"><a href="#how-you-can-build-a-serverless-api-using-graphql-net-core-c-and-vs-code" aria-hidden="true" class="header-anchor">#</a> How you can build a Serverless API using GraphQL .Net Core, C# and VS Code</h1> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/3fh654kg74d0ii58chs9.jpg" alt=""></p> <blockquote><p>This article takes you through how to build a full CRUD API using GraphQL. We end up hosting it in a Serverless function and also show how you can do external HTTP calls to build your API. Whether the data lives here or somewhere else doesn't matter. GraphQL is the front that your users will talk to.</p></blockquote> <p>TLDR; This article might be a bit long but it does teach a lot on GraphQL, queries, mutations. It also teaches you how to create a serverless function all in the context of .Net Core, C# and VS Code</p> <p>In this article we will:</p> <ul><li><strong>Learn</strong> how to build a full CRUD GraphQL including queries and mutations</li> <li><strong>Create</strong> a Serverless function and Host our GraphQL API in a function</li> <li><strong>Show</strong> how you can make an external HTTP call and make that part of our GraphQL API</li></ul> <h2 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h2> <ul><li><p><a href="https://dev.to/dotnet/learn-how-you-can-use-graphql-in-net-core-and-c-4h96?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Getting started with GraphQL in .Net<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
This is the first article I've written on the topic of GraphQL with .Net. I recommend you have a look to get a feeling for the basics of GraphQL.</p></li> <li><p><a href="https://graphql.org/" target="_blank" rel="noopener noreferrer">GraphQL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://docs.microsoft.com/azure/azure-functions/functions-create-first-function-vs-code?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Starting with Azure Functions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Covers creating a Serverless function and deploying to the Cloud using VS Code</p></li> <li><p><a href="https://docs.microsoft.com/azure/azure-functions/functions-dotnet-class-library?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Starting with Serverless in .Net<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
.Net C# Developer reference to Azure Functions</p></li> <li><p><a href="https://dev.to/azure/how-you-can-create-a-serverless-api-in-c-and-net-1ie?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Creating a Serverless API in C# and .Net<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Article I wrote covering how to create a CRUD API with Serverless, .Net, C#, and VS Code</p></li> <li><p><a href="https://docs.microsoft.com/learn/modules/create-serverless-logic-with-azure-functions/?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Create your first Serverless function<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
LEARN module for creating an Azure Function</p></li> <li><p><a href="https://azure.microsoft.com/free/?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Free Azure account<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
To deploy Serverless Azure Functions you will need a free Azure account)</p></li></ul> <h2 id="create-a-serverless-function-app"><a href="#create-a-serverless-function-app" aria-hidden="true" class="header-anchor">#</a> Create a Serverless function app</h2> <p>The first thing we will do is to create a Serverless function. But what is Serverless and why might it be useful in the context of GraphQL? That's really two questions but let's try to answer them in order.</p> <h3 id="why-serverless"><a href="#why-serverless" aria-hidden="true" class="header-anchor">#</a> Why Serverless?</h3> <p>Serverless is not about <em>no servers</em> but more about the server is NOT in your basement, anymore. In short, the servers have moved to the Cloud. That's not all, however. <em>Serverless</em> have come to mean other things namely that everything is set up for you. That means you don't need to think about what OS your code runs on or what Web Server runs it, everything is <em>managed</em>. There is more.</p> <blockquote><p>There is always more, isn't it? What now a fancy sticker?</p></blockquote> <p>It's about cost. Serverless usually means it's cheap.</p> <blockquote><p>Why is it cheap?</p></blockquote> <p>Well, Serverless code is meant to be run seldom and you are only billed for the time it executes</p> <blockquote><p>Ok, how do YOU make money?</p></blockquote> <p>Well, the function isn't always there. Whatever resources are needed are allocated when someone/something queries your function.</p> <blockquote><p>Doesn't that make it a bit slow like there could be some initial wait when it's scrambling to be created and then respond the query?</p></blockquote> <p>You are right. This is something called a <em>cold start</em>. This can be avoided however by either regularly polling our function or using a premium offering that shortens the <em>cold start</em>.</p> <blockquote><p>Ok so it's I can either have 100% availability or cheap, pick one 😃</p></blockquote> <p>I guess so.</p> <h3 id="why-serverless-with-graphql"><a href="#why-serverless-with-graphql" aria-hidden="true" class="header-anchor">#</a> Why Serverless with GraphQL?</h3> <p>Ok, we are a bit smarter about the <em>whats</em> and <em>whys</em> of Serverless so why add GraphQL to the mix?</p> <p>Well, GraphQL has the ability to stitch together data from different APIs so it could act as an API that aggregates data from different sources. So in a sense, it works well in the context of Serverless cause it's not like you need to have any data stored in the function if it's someone else's API.</p> <blockquote><p>Ok sounds good, I guess there are no other good reasons the rest is just about the hype that's GraphQL and Serverless right? 😉</p></blockquote> <p>...</p> <h3 id="prerequisits"><a href="#prerequisits" aria-hidden="true" class="header-anchor">#</a> Prerequisits</h3> <p>To create a Serverless function we first need a function app to put it in. To makes this as easy as possible we will be using VS Code and an Azure Function extension. So our prerequisites are:</p> <ol><li>Node.js</li> <li>Visual Studio Code</li> <li>Azure Functions extension</li></ol> <p>We can download Node.js from the following page:</p> <blockquote><p>https://nodejs.org/en/</p></blockquote> <p>You can find Visual Studio code here:</p> <blockquote><p>https://code.visualstudio.com/download</p></blockquote> <p>As for the extension we need. Search for an extension called <code>Azure Functions</code>. It should look like the below:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/tks3j4sv3xpr327u4zwd.png" alt=""></p> <h3 id="scaffold"><a href="#scaffold" aria-hidden="true" class="header-anchor">#</a> Scaffold</h3> <p>Ok, now we should be all setup and ready to create our first Serverless function. As mentioned before, the function needs to live within something called a function app. So we need to create the function app first.</p> <p>Hit <code>CMD+SHIFT+P</code> or choose <code>View/Command Palette</code> to bring up the command palette:</p> <p>Now we need to type a command that will help us create a Serverless function app. It's called <code>Azure Functions: Create New Project</code></p> <p>Then it's going to ask you for what directory to create the app. The directory you are standing in is the default chosen one, select that.</p> <p>Next thing it asks about is the language, select <code>C#</code>.</p> <p>Next up it's asking you about the projects first function and how it should be triggered. Select <code>HttpTrigger</code>.</p> <p>Now you need to provide a function name. Call it Graphql.</p> <p>Next question is a namespace. You could really choose anything here but let's call it <code>Function</code> just for the sake of it.</p> <p>Lastly, it asks about <code>Access Right</code>. There are different options here <code>Anonymous</code>, <code>Function</code>, <code>Admin</code>. We select <code>Anonymous</code> as we want to make our function publically available. The other options mean we would need to provide some kind of key when calling the function.</p> <p>VS Code should now scaffold all the needed files. It should also ask you to <code>restore</code> all dependencies, to download the libraries. You could also run</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dotnet restore
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>if you should miss clicking on this dialog.</p> <p>Your project structure should now look like this:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/5mf9mzd32g2fmygbmnir.png" alt=""></p> <h3 id="test-it-out"><a href="#test-it-out" aria-hidden="true" class="header-anchor">#</a> Test it out</h3> <p>Let's ensure that we can run our newly scaffolded function. First, you should have been prompted if you want to add the necessary to be able to debug. You should answer <code>YES</code> here. This will generate a directory <code>.vscode</code> looking like the below:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/qgttl2qmmzhbabtyxdbm.png" alt=""></p> <p>The <code>tasks.json</code> contains tasks needed to build, clean and run your project. These will assist you with the step we are about to do next <code>Debugging</code>.</p> <p>To Debug we choose <code>Debug/Start Debugging</code> from the menu. It should compile the code and once done it should look like this:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/uq3crqqdhp98y1kun069.png" alt=""></p> <p>It's telling us to go to <code>http://localhost:7071/api/Graphql</code></p> <p>Let's spin up a browser:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/j4mb132acmcat6wjtvf7.png" alt=""></p> <p>Seems to work alright. 😃</p> <p>It's hitting our function <code>Graphql</code>. Speaking of which, let's have a quick look at the sample code we've been given when we scaffolded the Serverless app:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// Graphql.cs</span>

<span class="token keyword">using</span> System<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Mvc<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>WebJobs<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>WebJobs<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Http<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Http<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Logging<span class="token punctuation">;</span>
<span class="token keyword">using</span> Newtonsoft<span class="token punctuation">.</span>Json<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> Function
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Graphql</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;Graphql&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>IActionResult<span class="token operator">&gt;</span> <span class="token function">Run</span><span class="token punctuation">(</span>
            <span class="token punctuation">[</span><span class="token class-name">HttpTrigger</span><span class="token punctuation">(</span>AuthorizationLevel<span class="token punctuation">.</span>Anonymous<span class="token punctuation">,</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> Route <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token class-name">HttpRequest</span> req<span class="token punctuation">,</span>
            <span class="token class-name">ILogger</span> log<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">LogInformation</span><span class="token punctuation">(</span><span class="token string">&quot;C# HTTP trigger function processed a request.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">string</span> name <span class="token operator">=</span> req<span class="token punctuation">.</span>Query<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">string</span> requestBody <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">StreamReader</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ReadToEndAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">dynamic</span> data <span class="token operator">=</span> JsonConvert<span class="token punctuation">.</span><span class="token function">DeserializeObject</span><span class="token punctuation">(</span>requestBody<span class="token punctuation">)</span><span class="token punctuation">;</span>
            name <span class="token operator">=</span> name <span class="token operator">??</span> data<span class="token punctuation">?.</span>name<span class="token punctuation">;</span>

            <span class="token keyword">return</span> name <span class="token operator">!=</span> <span class="token keyword">null</span>
                <span class="token punctuation">?</span> <span class="token punctuation">(</span>ActionResult<span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">OkObjectResult</span><span class="token punctuation">(</span>$<span class="token string">&quot;Hello, {name}&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">BadRequestObjectResult</span><span class="token punctuation">(</span><span class="token string">&quot;Please pass a name on the query string or in the request body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>Let's not spend to much time understanding everything right now but suffice to say it does its job and is able to work with query parameters:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">string</span> name <span class="token operator">=</span> req<span class="token punctuation">.</span>Query<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>and the Body, in case you POST a request:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">string</span> requestBody <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">StreamReader</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ReadToEndAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">dynamic</span> data <span class="token operator">=</span> JsonConvert<span class="token punctuation">.</span><span class="token function">DeserializeObject</span><span class="token punctuation">(</span>requestBody<span class="token punctuation">)</span><span class="token punctuation">;</span>
name <span class="token operator">=</span> name <span class="token operator">??</span> data<span class="token punctuation">?.</span>name<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Next, let's talk GraphQL.</p> <p>## Adding GraphQL to Serverless</p> <p>Ok, we established that we wanted to add GraphQL to our Serverless function. First, let's build a GraphQL API. Any GraphQL will contain the same moving parts:</p> <ul><li><strong>A Schema</strong>, this will define what we can query for and what custom data types we have</li> <li><strong>A Resolver</strong>, a collection of functions that is able to respond to a request and ends up delivering a response</li></ul> <h3 id="adding-a-graphql-schema"><a href="#adding-a-graphql-schema" aria-hidden="true" class="header-anchor">#</a> Adding a GraphQL schema</h3> <p>This will be authored in something called GQL or <strong>G</strong>raphQL <strong>Q</strong>uery <strong>L</strong>anguage. Our schema will look like the following:</p> <div class="language-gql line-numbers-mode"><pre class="language-text"><code>type Jedi {
  id: ID
  name: String,
  side: String
}

input JediInput {
  name: String
  side: String
  id: ID
}

type Mutation {
  addJedi(input: JediInput): Jedi
  updateJedi(input: JediInput ): Jedi
  removeJedi(id: ID): String
}

type Query {
    jedis: [Jedi]
    jedi(id: ID): Jedi
    hello: String
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>Now that's a lot. Let's explain what we are looking at.</p> <p><strong>Query</strong></p> <p>Anything of type <code>Query</code> or <code>Mutation</code> is something we can ask for in our query to our API. The semantic meaning of <code>Query</code> is that you want to <em>fetch</em> data. In this case, we want to fetch a list of jedis using a query syntax like this:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
  jedis { name side }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>This is equivalent to writing the following in SQL:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT name, side
FROM jedis;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>The other thing we do is supporting a query with a parameter, namely <code>jedi(id: ID): Jedi</code>. We call it like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{ 
  jedi(id: 1) { name }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>This is equivalent to writing the following in SQL:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>SELECT name
FROM jedi
WHERE id=1;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Custom types</strong></p> <p>Everything queryable was defined under <code>type Query</code>. Everything else except for <code>type Mutation</code> are custom types that we define. For example:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>type Jedi {
  id: ID
  name: String,
  side: String
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>Mutation</strong></p> <p>This semantically means we will try to change the data. Looking at the operations we support:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>addJedi(input: JediInput): Jedi
updateJedi(input: JediInput ): Jedi
removeJedi(id: ID): String
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>We can see that we support adding, updating and removal.</p> <p>To call a mutation we need to type like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mutation test { 
  addJedi(input: { 
    name: &quot;JarJar&quot;, 
    side: &quot;Dark&quot;  
  }) { name } 
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>Input, complex input for our Mutation</strong></p> <p>Note the input property <code>input</code> in <code>addJedi()</code>. If we look at the schema we can see that it's of type <code>JediInput</code> which is defined like this:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>input JediInput {
  name: String
  side: String
  id: ID
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>The reason we are using the keyword <code>input</code> instead of <code>type</code> is that this is a special case. Special how, you wonder? Well, there are two types of input parameters to a mutation:</p> <ol><li><strong>Scalars</strong>, this is a String, ID, Boolean, etc, also called primitives</li> <li><strong>Inputs</strong>, this is nothing more than a complex data type with many properties on it, example <code>JediInput</code></li></ol> <p>so it's definitely possible to define a mutation looking like this:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>type Mutation {
  addTodo(todo: String!): String
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>So the million-dollar question is why can't I just use a custom type like <code>Jedi</code> as an input parameter type to my mutation?</p> <blockquote><p>The honest answer is I don't know.</p></blockquote> <p>Just remember this: If you need an input parameter that is more complex than a scalar, then you need to define it like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>input MyInputType {
  // my columns
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Add NuGet package</strong></p> <p>Ok next step is to set up this schema properly in code. For that we will create a file <code>Server.cs</code> and also install the GraphQL package like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dotnet add package GraphQL 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>Create a Schema</strong></p> <p>Now add the following code to <code>Server.cs</code>, like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">using</span> GraphQL<span class="token punctuation">;</span>
<span class="token keyword">using</span> GraphQL<span class="token punctuation">.</span>Types<span class="token punctuation">;</span>
<span class="token keyword">using</span> Newtonsoft<span class="token punctuation">.</span>Json<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> Function <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Server</span> 
  <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">ISchema</span> schema <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token function">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>schema <span class="token operator">=</span> Schema<span class="token punctuation">.</span><span class="token function">For</span><span class="token punctuation">(</span><span class="token string">@&quot;
          type Jedi {
            id: ID
            name: String,
            side: String
          }

          input JediInput {
            name: String
            side: String
            id: ID
          }

          type Mutation {
            addJedi(input: JediInput): Jedi
            updateJedi(input: JediInput ): Jedi
            removeJedi(id: ID): String
          }

          type Query {
              jedis: [Jedi]
              jedi(id: ID): Jedi
          }
      &quot;</span><span class="token punctuation">,</span> _ <span class="token operator">=&gt;</span>
      <span class="token punctuation">{</span>
        _<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Include</span><span class="token punctuation">&lt;</span><span class="token class-name">Query</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Include</span><span class="token punctuation">&lt;</span><span class="token class-name">Mutation</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">&gt;</span> <span class="token function">QueryAsync</span><span class="token punctuation">(</span><span class="token keyword">string</span> query<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
      <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">DocumentExecuter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ExecuteAsync</span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span>
      <span class="token punctuation">{</span>
        _<span class="token punctuation">.</span>Schema <span class="token operator">=</span> schema<span class="token punctuation">;</span>
        _<span class="token punctuation">.</span>Query <span class="token operator">=</span> query<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>Errors <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> result<span class="token punctuation">.</span>Errors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Message<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> JsonConvert<span class="token punctuation">.</span><span class="token function">SerializeObject</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><p>In the constructor above we set up the Schema by calling <code>Schema.For()</code> with a string representing our schema expressed as GQL. The second argument of that won't compile though, namely this part:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>_ <span class="token operator">=&gt;</span>
  <span class="token punctuation">{</span>
    _<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Include</span><span class="token punctuation">&lt;</span><span class="token class-name">Query</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Include</span><span class="token punctuation">&lt;</span><span class="token class-name">Mutation</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="adding-resolvers"><a href="#adding-resolvers" aria-hidden="true" class="header-anchor">#</a> Adding resolvers</h3> <p>The reason is it won't compile is that <code>Query</code> and <code>Mutation</code> don't exist yet. They are simply resolver classes answering to query and mutation requests. Let's make it compile by creating first <code>Db.cs</code> and a file <code>Query.cs</code></p> <p><strong>Adding in-memory database</strong></p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// Db.cs</span>

<span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Linq<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> Function
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StarWarsDB</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> List<span class="token operator">&lt;</span>Jedi<span class="token operator">&gt;</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Jedi</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">new</span> <span class="token class-name">Jedi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Name <span class="token operator">=</span><span class="token string">&quot;Luke&quot;</span><span class="token punctuation">,</span> Side<span class="token operator">=</span><span class="token string">&quot;Light&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name">Jedi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> Name <span class="token operator">=</span><span class="token string">&quot;Yoda&quot;</span><span class="token punctuation">,</span> Side<span class="token operator">=</span><span class="token string">&quot;Light&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name">Jedi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> Name <span class="token operator">=</span><span class="token string">&quot;Darth Vader&quot;</span><span class="token punctuation">,</span> Side<span class="token operator">=</span><span class="token string">&quot;Dark&quot;</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> IEnumerable<span class="token operator">&lt;</span>Jedi<span class="token operator">&gt;</span> <span class="token function">GetJedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">return</span> jedis<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Jedi</span> <span class="token function">AddJedi</span><span class="token punctuation">(</span><span class="token class-name">Jedi</span> jedi<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      jedi<span class="token punctuation">.</span>Id <span class="token operator">=</span> jedis<span class="token punctuation">.</span>Count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
      jedis<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>jedi<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> jedi<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Jedi</span> <span class="token function">UpdateJedi</span><span class="token punctuation">(</span><span class="token class-name">Jedi</span> jedi<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">var</span> toUpdate <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span>j <span class="token operator">=&gt;</span> j<span class="token punctuation">.</span>Id <span class="token operator">==</span> jedi<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
      toUpdate<span class="token punctuation">.</span>Name <span class="token operator">=</span> jedi<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
      toUpdate<span class="token punctuation">.</span>Side <span class="token operator">=</span> jedi<span class="token punctuation">.</span>Side<span class="token punctuation">;</span>
      <span class="token keyword">return</span> toUpdate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">string</span> <span class="token function">RemoveJedi</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">var</span> toRemove <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span>j <span class="token operator">=&gt;</span> j<span class="token punctuation">.</span>Id <span class="token operator">==</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
      jedis<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>toRemove<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Jedi</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">string</span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">string</span> Side <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p><code>Db.cs</code> is nothing more than a simple in-memory database.</p> <p><strong>Adding a  resolver class to handle all Queries</strong></p> <p>Next, let's create <code>Query.cs</code>:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// Query.cs</span>

<span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
<span class="token keyword">using</span> GraphQL<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Linq<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> Function
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Query</span>
  <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token class-name">GraphQLMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;jedis&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> IEnumerable<span class="token operator">&lt;</span>Jedi<span class="token operator">&gt;</span> <span class="token function">GetJedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">return</span> StarWarsDB<span class="token punctuation">.</span><span class="token function">GetJedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token class-name">GraphQLMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;jedi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token class-name">Jedi</span> <span class="token function">GetJedi</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">return</span> StarWarsDB<span class="token punctuation">.</span><span class="token function">GetJedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span>j <span class="token operator">=&gt;</span> j<span class="token punctuation">.</span>Id <span class="token operator">==</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token class-name">GraphQLMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">string</span> <span class="token function">GetHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>What's interesting about the above is how we map something in our GraphQL schema to a resolver function. For that we use the decorator <code>GraphQLMetadata</code> like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">GraphQLMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;jedis&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> IEnumerable<span class="token operator">&lt;</span>Jedi<span class="token operator">&gt;</span> <span class="token function">GetJedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">return</span> StarWarsDB<span class="token punctuation">.</span><span class="token function">GetJedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>The above tells us that if the user queries for <code>jedis</code> then the function <code>GetJedis()</code> will respond.</p> <p>Dealing with parameters is almost as easy. It's the same decorator but we just add input parameter like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">GraphQLMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;jedi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token class-name">Jedi</span> <span class="token function">GetJedi</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">return</span> StarWarsDB<span class="token punctuation">.</span><span class="token function">GetJedis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SingleOrDefault</span><span class="token punctuation">(</span>j <span class="token operator">=&gt;</span> j<span class="token punctuation">.</span>Id <span class="token operator">==</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>Adding a  resolver class to handle all Mutation requests</strong></p> <p>We are almost there but we need the class <code>Mutation.cs</code> and let's add the following content to it:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// Mutation.cs</span>

<span class="token keyword">using</span> GraphQL<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> Function <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Mutation</span>
  <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token class-name">GraphQLMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;addJedi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token class-name">Jedi</span> <span class="token function">AddJedi</span><span class="token punctuation">(</span><span class="token class-name">Jedi</span>  input<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
      <span class="token keyword">return</span> StarWarsDB<span class="token punctuation">.</span><span class="token function">AddJedi</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token class-name">GraphQLMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;updateJedi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token class-name">Jedi</span> <span class="token function">UpdateJedi</span><span class="token punctuation">(</span><span class="token class-name">Jedi</span> input<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">return</span> StarWarsDB<span class="token punctuation">.</span><span class="token function">AddJedi</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token class-name">GraphQLMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;removeJedi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">string</span> <span class="token function">AddJedi</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">return</span> StarWarsDB<span class="token punctuation">.</span><span class="token function">RemoveJedi</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>As you can see it looks very similar to <code>Query.cs</code>, even with parameter handling.</p> <p><strong>Updating our Serverless function</strong></p> <p>There's just one piece left of the puzzle, namely our serverless function. It needs to be altered so we can support the user to invoke our function like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>url?query={ jedis } { name }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Change the code in <code>Graphql.cs</code> to the following:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>
<span class="token keyword">using</span> System<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Mvc<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>WebJobs<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>WebJobs<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Http<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Http<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Logging<span class="token punctuation">;</span>
<span class="token keyword">using</span> Newtonsoft<span class="token punctuation">.</span>Json<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> Function
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">GraphQL</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;GraphQL&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>IActionResult<span class="token operator">&gt;</span> <span class="token function">Run</span><span class="token punctuation">(</span>
            <span class="token punctuation">[</span><span class="token class-name">HttpTrigger</span><span class="token punctuation">(</span>AuthorizationLevel<span class="token punctuation">.</span>Anonymous<span class="token punctuation">,</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> Route <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token class-name">HttpRequest</span> req<span class="token punctuation">,</span>
            <span class="token class-name">ILogger</span> log<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">var</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> query <span class="token operator">=</span> req<span class="token punctuation">.</span>Query<span class="token punctuation">[</span><span class="token string">&quot;query&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// string query = &quot;mutation test { addJedi(input: { name: \&quot;JarJar\&quot;, side: \&quot;Dark\&quot;  }) { name } }&quot;;</span>

            <span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token keyword">await</span> server<span class="token punctuation">.</span><span class="token function">QueryAsync</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">OkObjectResult</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="test-it-all-out"><a href="#test-it-all-out" aria-hidden="true" class="header-anchor">#</a> Test it all out</h3> <p>To test it we just start debugging by choosing <code>Debug/Start Debugging</code> from the menu and change the URL in the browser to:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://localhost:7071/api/GraphQL?query={ jedis { name } }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Let's see what the browser says:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/m5t7d3aiwggazkpl7den.png" alt=""></p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/76xk54ulkvlggtgsrq8b.gif" alt=""></p> <p>Yep, we did it. Serverless function with a GraphQL API.</p> <h2 id="bonus-calling-other-endpoints"><a href="#bonus-calling-other-endpoints" aria-hidden="true" class="header-anchor">#</a> Bonus - calling other endpoints</h2> <p>Now. One of the great things about GraphQL is that it allows us to call other APIs and thereby GraphQL acts as an aggregation layer. We can easily achieve that by the following steps:</p> <ol><li><strong>Do the HTTP request</strong>, this should do the request to our external API</li> <li><strong>Add  resolver method</strong> for our <em>external</em> call</li> <li><strong>Update our schema</strong> with the new type</li> <li><strong>Test</strong> it out</li></ol> <h3 id="http-request"><a href="#http-request" aria-hidden="true" class="header-anchor">#</a> HTTP Request</h3> <p>We can easily do HTTP request in .Net with <code>HttpClient</code> so let's create a class <code>Fetch.cs</code> like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// Fetch.cs</span>

<span class="token keyword">using</span> System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> Function <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Fetch</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">string</span> BaseUrl <span class="token operator">=</span> <span class="token string">&quot;https://swapi.co/api&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">&gt;</span> <span class="token function">ByUrl</span><span class="token punctuation">(</span><span class="token keyword">string</span> url<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token keyword">var</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">GetStringAsync</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">&quot;{0}/{1}&quot;</span><span class="token punctuation">,</span> BaseUrl<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> json<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="add-resolver-method"><a href="#add-resolver-method" aria-hidden="true" class="header-anchor">#</a> Add resolver method</h3> <p>Now open up <code>Query.cs</code> and add the following method to the <code>Query</code> class:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">GraphQLMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;planets&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Planet<span class="token operator">&gt;&gt;</span> <span class="token function">GetPlanet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">{</span>
    <span class="token keyword">var</span> planets <span class="token operator">=</span> <span class="token keyword">await</span> Fetch<span class="token punctuation">.</span><span class="token function">ByUrl</span><span class="token punctuation">(</span><span class="token string">&quot;planets/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> JsonConvert<span class="token punctuation">.</span>DeserializeObject<span class="token operator">&lt;</span>Result<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Planet<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>planets<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">.</span>results<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Additionally, we should be installing a new NuGet package:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dotnet add package Newtonsoft.Json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This is needed so we can convert the JSON response we get into a Poco.</p> <p>We should also add types <code>Planet</code> and <code>Result</code> to <code>Query.cs</code>, but outside the class definition:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span>T<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> count <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">T</span> results <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Planet</span>
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">string</span> name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="update-our-schema-with-the-new-type"><a href="#update-our-schema-with-the-new-type" aria-hidden="true" class="header-anchor">#</a> Update our schema with the new type</h3> <p>We have the schema left to update before we can try it out. So let's open up <code>Schema.cs</code> and make sure it now looks like this:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">this</span><span class="token punctuation">.</span>schema <span class="token operator">=</span> Schema<span class="token punctuation">.</span><span class="token function">For</span><span class="token punctuation">(</span><span class="token string">@&quot;
          type Planet {
            name: String
          }

          type Jedi {
            id: ID
            name: String,
            side: String
          }

          input JediInput {
            name: String
            side: String
            id: ID
          }

          type Mutation {
            addJedi(input: JediInput): Jedi
            updateJedi(input: JediInput ): Jedi
            removeJedi(id: ID): String
          }

          type Query {
              jedis: [Jedi]
              jedi(id: ID): Jedi
              hello: String
              planets: [Planet]
          }
      &quot;</span><span class="token punctuation">,</span> _ <span class="token operator">=&gt;</span>
      <span class="token punctuation">{</span>
        _<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Include</span><span class="token punctuation">&lt;</span><span class="token class-name">Query</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _<span class="token punctuation">.</span>Types<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Include</span><span class="token punctuation">&lt;</span><span class="token class-name">Mutation</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>Above we've added the type <code>Planet</code>:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>type Planet {
  name: String
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>We've also added <code>planets</code> to <code>Query</code>:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>planets: [Planet]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="testing-it-out"><a href="#testing-it-out" aria-hidden="true" class="header-anchor">#</a> Testing it out</h3> <p>That should be it, let's test it. <code>Debug/Start Debugging</code>:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://localhost:7071/api/GraphQL?query={ planets { name } }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://thepracticaldev.s3.amazonaws.com/i/dr5i0mqk4djyhl4yskak.png" alt=""></p> <p>There we have it. 😃</p> <p>We've managed to do an external call to an API and make that part of our GraphQL API. As you can see we can intermix data from different sources easily.</p> <h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>We've managed to create a GraphQL that supports the full CRUD. That is we support both querying for data but also creating, update and delete.</p> <p>Additionally, we've taken our first steps with Serverless functions.</p> <p>Finally, we added our GraphQL API to be served by our Serverless function.</p> <p>As an added bonus we also showed how we could take to external APIs and make them part of our API. That's really powerful stuff.</p> <p>I hope you enjoyed this article. In out next part we will take a look at how to add GraphQL to a Web API project in .Net Core.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.95c997f3.js" defer></script><script src="/assets/js/9.454b5262.js" defer></script><script src="/assets/js/4.eac68367.js" defer></script><script src="/assets/js/151.8267fcff.js" defer></script>
  </body>
</html>
