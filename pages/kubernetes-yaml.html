<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How YOU actually use Kubernetes, starring YAML files</title>
    <meta name="description" content="[object Object]">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.1f33e7c2.css" as="style"><link rel="preload" href="/assets/js/app.95c997f3.js" as="script"><link rel="preload" href="/assets/js/9.454b5262.js" as="script"><link rel="preload" href="/assets/js/4.eac68367.js" as="script"><link rel="preload" href="/assets/js/186.e17f8c1c.js" as="script"><link rel="prefetch" href="/assets/js/1.36663999.js"><link rel="prefetch" href="/assets/js/10.6aaebcfe.js"><link rel="prefetch" href="/assets/js/100.f7776fae.js"><link rel="prefetch" href="/assets/js/101.83c4ff25.js"><link rel="prefetch" href="/assets/js/102.d3a51c53.js"><link rel="prefetch" href="/assets/js/103.005176e9.js"><link rel="prefetch" href="/assets/js/104.ad6ac0a2.js"><link rel="prefetch" href="/assets/js/105.1c2918c1.js"><link rel="prefetch" href="/assets/js/106.84577e76.js"><link rel="prefetch" href="/assets/js/107.39206cda.js"><link rel="prefetch" href="/assets/js/108.b717e412.js"><link rel="prefetch" href="/assets/js/109.a0275c41.js"><link rel="prefetch" href="/assets/js/11.e44a9c79.js"><link rel="prefetch" href="/assets/js/110.acd428a7.js"><link rel="prefetch" href="/assets/js/111.85c1f355.js"><link rel="prefetch" href="/assets/js/112.62bab5e5.js"><link rel="prefetch" href="/assets/js/113.30083b82.js"><link rel="prefetch" href="/assets/js/114.2dcc568f.js"><link rel="prefetch" href="/assets/js/115.2ee55351.js"><link rel="prefetch" href="/assets/js/116.44cdb765.js"><link rel="prefetch" href="/assets/js/117.f22ffed2.js"><link rel="prefetch" href="/assets/js/118.fda8edf7.js"><link rel="prefetch" href="/assets/js/119.1ea9eae7.js"><link rel="prefetch" href="/assets/js/12.02e6e552.js"><link rel="prefetch" href="/assets/js/120.cf073939.js"><link rel="prefetch" href="/assets/js/121.d06bb8bc.js"><link rel="prefetch" href="/assets/js/122.533a0953.js"><link rel="prefetch" href="/assets/js/123.382bf140.js"><link rel="prefetch" href="/assets/js/124.1e416617.js"><link rel="prefetch" href="/assets/js/125.88e1d9ef.js"><link rel="prefetch" href="/assets/js/126.ac7f0ed9.js"><link rel="prefetch" href="/assets/js/127.2452b31c.js"><link rel="prefetch" href="/assets/js/128.4387dd5e.js"><link rel="prefetch" href="/assets/js/129.57ea763a.js"><link rel="prefetch" href="/assets/js/13.215ad842.js"><link rel="prefetch" href="/assets/js/130.db7a97a9.js"><link rel="prefetch" href="/assets/js/131.cb028185.js"><link rel="prefetch" href="/assets/js/132.1f53aba9.js"><link rel="prefetch" href="/assets/js/133.3e4f88da.js"><link rel="prefetch" href="/assets/js/134.78b60412.js"><link rel="prefetch" href="/assets/js/135.67d56f81.js"><link rel="prefetch" href="/assets/js/136.5f5c962b.js"><link rel="prefetch" href="/assets/js/137.a4bdc628.js"><link rel="prefetch" href="/assets/js/138.9e4dca1e.js"><link rel="prefetch" href="/assets/js/139.ff87d106.js"><link rel="prefetch" href="/assets/js/14.12340cee.js"><link rel="prefetch" href="/assets/js/140.345c5f56.js"><link rel="prefetch" href="/assets/js/141.7ca86301.js"><link rel="prefetch" href="/assets/js/142.dd05b794.js"><link rel="prefetch" href="/assets/js/143.c0950d2f.js"><link rel="prefetch" href="/assets/js/144.e36983d5.js"><link rel="prefetch" href="/assets/js/145.0fe3cd59.js"><link rel="prefetch" href="/assets/js/146.cabf0d13.js"><link rel="prefetch" href="/assets/js/147.41e37bae.js"><link rel="prefetch" href="/assets/js/148.1aff1942.js"><link rel="prefetch" href="/assets/js/149.43ddd51d.js"><link rel="prefetch" href="/assets/js/15.34674cd6.js"><link rel="prefetch" href="/assets/js/150.2dcc7e56.js"><link rel="prefetch" href="/assets/js/151.8267fcff.js"><link rel="prefetch" href="/assets/js/152.19aac962.js"><link rel="prefetch" href="/assets/js/153.90c26683.js"><link rel="prefetch" href="/assets/js/154.11f5eee4.js"><link rel="prefetch" href="/assets/js/155.fcfefbc5.js"><link rel="prefetch" href="/assets/js/156.8d837db5.js"><link rel="prefetch" href="/assets/js/157.347109ba.js"><link rel="prefetch" href="/assets/js/158.ad5d15c7.js"><link rel="prefetch" href="/assets/js/159.fa03b2bf.js"><link rel="prefetch" href="/assets/js/16.119e91d4.js"><link rel="prefetch" href="/assets/js/160.77c40a45.js"><link rel="prefetch" href="/assets/js/161.bc50d184.js"><link rel="prefetch" href="/assets/js/162.6eb99077.js"><link rel="prefetch" href="/assets/js/163.7daf038b.js"><link rel="prefetch" href="/assets/js/164.29a5a4a0.js"><link rel="prefetch" href="/assets/js/165.2158f290.js"><link rel="prefetch" href="/assets/js/166.7edeee8d.js"><link rel="prefetch" href="/assets/js/167.7fba076e.js"><link rel="prefetch" href="/assets/js/168.aee92853.js"><link rel="prefetch" href="/assets/js/169.f1c69f9e.js"><link rel="prefetch" href="/assets/js/17.780050f1.js"><link rel="prefetch" href="/assets/js/170.c3db9ca3.js"><link rel="prefetch" href="/assets/js/171.39f16573.js"><link rel="prefetch" href="/assets/js/172.854c26f8.js"><link rel="prefetch" href="/assets/js/173.7ac7eb22.js"><link rel="prefetch" href="/assets/js/174.8b371e6b.js"><link rel="prefetch" href="/assets/js/175.2ea22ad4.js"><link rel="prefetch" href="/assets/js/176.342164c7.js"><link rel="prefetch" href="/assets/js/177.ca5f8796.js"><link rel="prefetch" href="/assets/js/178.b191bdb8.js"><link rel="prefetch" href="/assets/js/179.976e6278.js"><link rel="prefetch" href="/assets/js/18.053933da.js"><link rel="prefetch" href="/assets/js/180.aedfb4ca.js"><link rel="prefetch" href="/assets/js/181.e5449166.js"><link rel="prefetch" href="/assets/js/182.903ca4cf.js"><link rel="prefetch" href="/assets/js/183.f2506256.js"><link rel="prefetch" href="/assets/js/184.07b6cfc7.js"><link rel="prefetch" href="/assets/js/185.e92dcf96.js"><link rel="prefetch" href="/assets/js/187.99170016.js"><link rel="prefetch" href="/assets/js/188.90581d2f.js"><link rel="prefetch" href="/assets/js/189.0e1a3abe.js"><link rel="prefetch" href="/assets/js/19.910fc8d0.js"><link rel="prefetch" href="/assets/js/190.41b9ccd3.js"><link rel="prefetch" href="/assets/js/191.4add1d16.js"><link rel="prefetch" href="/assets/js/192.b2cb6399.js"><link rel="prefetch" href="/assets/js/193.b4035cf0.js"><link rel="prefetch" href="/assets/js/194.aca90bf6.js"><link rel="prefetch" href="/assets/js/195.6fa13ccd.js"><link rel="prefetch" href="/assets/js/196.269c7fdd.js"><link rel="prefetch" href="/assets/js/197.9c2db328.js"><link rel="prefetch" href="/assets/js/198.9e158af1.js"><link rel="prefetch" href="/assets/js/199.72ae3d2d.js"><link rel="prefetch" href="/assets/js/20.e8c8408a.js"><link rel="prefetch" href="/assets/js/200.2b7692a5.js"><link rel="prefetch" href="/assets/js/201.47c19701.js"><link rel="prefetch" href="/assets/js/202.c234220d.js"><link rel="prefetch" href="/assets/js/203.238a75d6.js"><link rel="prefetch" href="/assets/js/204.71c0bf86.js"><link rel="prefetch" href="/assets/js/21.287aba19.js"><link rel="prefetch" href="/assets/js/22.f4b7a74b.js"><link rel="prefetch" href="/assets/js/23.fa51555f.js"><link rel="prefetch" href="/assets/js/24.cd8d9d78.js"><link rel="prefetch" href="/assets/js/25.a9fce161.js"><link rel="prefetch" href="/assets/js/26.e3067144.js"><link rel="prefetch" href="/assets/js/27.0610f28c.js"><link rel="prefetch" href="/assets/js/28.f1b496e3.js"><link rel="prefetch" href="/assets/js/29.ef58c202.js"><link rel="prefetch" href="/assets/js/3.970a66a4.js"><link rel="prefetch" href="/assets/js/30.ae297928.js"><link rel="prefetch" href="/assets/js/31.4fd0d93b.js"><link rel="prefetch" href="/assets/js/32.07e772d9.js"><link rel="prefetch" href="/assets/js/33.8045f864.js"><link rel="prefetch" href="/assets/js/34.295422ff.js"><link rel="prefetch" href="/assets/js/35.39e60c42.js"><link rel="prefetch" href="/assets/js/36.fddd48a5.js"><link rel="prefetch" href="/assets/js/37.367a54b5.js"><link rel="prefetch" href="/assets/js/38.a612debc.js"><link rel="prefetch" href="/assets/js/39.94b70e03.js"><link rel="prefetch" href="/assets/js/40.b4ed34c8.js"><link rel="prefetch" href="/assets/js/41.390ffe47.js"><link rel="prefetch" href="/assets/js/42.55e09873.js"><link rel="prefetch" href="/assets/js/43.8065223a.js"><link rel="prefetch" href="/assets/js/44.786fa232.js"><link rel="prefetch" href="/assets/js/45.89a5cd81.js"><link rel="prefetch" href="/assets/js/46.74ac226f.js"><link rel="prefetch" href="/assets/js/47.3bc4cde3.js"><link rel="prefetch" href="/assets/js/48.4ee9fba2.js"><link rel="prefetch" href="/assets/js/49.02a5f0f0.js"><link rel="prefetch" href="/assets/js/5.d1da013e.js"><link rel="prefetch" href="/assets/js/50.5bffa682.js"><link rel="prefetch" href="/assets/js/51.51580cbc.js"><link rel="prefetch" href="/assets/js/52.e69de275.js"><link rel="prefetch" href="/assets/js/53.326a7442.js"><link rel="prefetch" href="/assets/js/54.222addc9.js"><link rel="prefetch" href="/assets/js/55.bd4d5a38.js"><link rel="prefetch" href="/assets/js/56.e14027f4.js"><link rel="prefetch" href="/assets/js/57.949f3da5.js"><link rel="prefetch" href="/assets/js/58.f45aeb0d.js"><link rel="prefetch" href="/assets/js/59.a537c130.js"><link rel="prefetch" href="/assets/js/6.9bdf2d86.js"><link rel="prefetch" href="/assets/js/60.17850c9d.js"><link rel="prefetch" href="/assets/js/61.a9f91faa.js"><link rel="prefetch" href="/assets/js/62.24f5a40d.js"><link rel="prefetch" href="/assets/js/63.60a38d5b.js"><link rel="prefetch" href="/assets/js/64.ecda83e6.js"><link rel="prefetch" href="/assets/js/65.5ac936d7.js"><link rel="prefetch" href="/assets/js/66.ae14e9b3.js"><link rel="prefetch" href="/assets/js/67.6f7c9f8c.js"><link rel="prefetch" href="/assets/js/68.006a7e36.js"><link rel="prefetch" href="/assets/js/69.9d3a3878.js"><link rel="prefetch" href="/assets/js/7.9ac2367b.js"><link rel="prefetch" href="/assets/js/70.4a3f6622.js"><link rel="prefetch" href="/assets/js/71.6d7fab1a.js"><link rel="prefetch" href="/assets/js/72.fab91def.js"><link rel="prefetch" href="/assets/js/73.d791feee.js"><link rel="prefetch" href="/assets/js/74.2801f4e5.js"><link rel="prefetch" href="/assets/js/75.981b86e2.js"><link rel="prefetch" href="/assets/js/76.6241dd05.js"><link rel="prefetch" href="/assets/js/77.da0cc43e.js"><link rel="prefetch" href="/assets/js/78.bf5853c2.js"><link rel="prefetch" href="/assets/js/79.112a39ee.js"><link rel="prefetch" href="/assets/js/8.6b13a443.js"><link rel="prefetch" href="/assets/js/80.f2ed7194.js"><link rel="prefetch" href="/assets/js/81.4b4b8b2f.js"><link rel="prefetch" href="/assets/js/82.65bb49d8.js"><link rel="prefetch" href="/assets/js/83.80cc0629.js"><link rel="prefetch" href="/assets/js/84.f8c4a382.js"><link rel="prefetch" href="/assets/js/85.09c8c91b.js"><link rel="prefetch" href="/assets/js/86.1ff26044.js"><link rel="prefetch" href="/assets/js/87.79d46ddd.js"><link rel="prefetch" href="/assets/js/88.d7051ae9.js"><link rel="prefetch" href="/assets/js/89.ceed231e.js"><link rel="prefetch" href="/assets/js/90.cb5b9f7e.js"><link rel="prefetch" href="/assets/js/91.4c76179c.js"><link rel="prefetch" href="/assets/js/92.f68b9b5c.js"><link rel="prefetch" href="/assets/js/93.f9f451c7.js"><link rel="prefetch" href="/assets/js/94.38528942.js"><link rel="prefetch" href="/assets/js/95.41439023.js"><link rel="prefetch" href="/assets/js/96.bff3c86e.js"><link rel="prefetch" href="/assets/js/97.b6ad2632.js"><link rel="prefetch" href="/assets/js/98.9157217b.js"><link rel="prefetch" href="/assets/js/99.9fedc5bd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1f33e7c2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>How YOU actually use Kubernetes, starring YAML files</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/kubernetes-yaml.html#resources" class="sidebar-link">Resources</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/kubernetes-yaml.html#the-yaml-format" class="sidebar-link">The YAML format</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/kubernetes-yaml.html#maps" class="sidebar-link">Maps</a></li><li class="sidebar-sub-header"><a href="/pages/kubernetes-yaml.html#lists" class="sidebar-link">Lists</a></li></ul></li><li><a href="/pages/kubernetes-yaml.html#yaml-in-kubernetes" class="sidebar-link">YAML In Kubernetes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/kubernetes-yaml.html#describe-and-deploy-a-pod" class="sidebar-link">Describe and deploy a Pod</a></li><li class="sidebar-sub-header"><a href="/pages/kubernetes-yaml.html#deploying-our-pod-yaml" class="sidebar-link">Deploying our POD YAML</a></li><li class="sidebar-sub-header"><a href="/pages/kubernetes-yaml.html#deployment" class="sidebar-link">Deployment</a></li></ul></li><li><a href="/pages/kubernetes-yaml.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="how-you-actually-use-kubernetes-starring-yaml-files"><a href="#how-you-actually-use-kubernetes-starring-yaml-files" aria-hidden="true" class="header-anchor">#</a> How YOU actually use Kubernetes, starring YAML files</h1> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/ibhdlncwacr68gip80ai.jpg" alt=""></p> <blockquote><p>I've described concepts such as Minkube, Pods, Nodes, Services and more over the course of four articles. Although educational you are likely to use Kubernetes in a different way than how I been showing you so far, you are likely to use YAML files</p></blockquote> <p>YAML files are files that let us define a configuration of whatever it may be.</p> <blockquote><p>YAML as in Y A M L, aka Y M C A? 😃</p></blockquote> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/pdkhfkeu5sqyngcpt6st.gif" alt=""></p> <p>No, not like that, more YAML as in Camel</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/rq94nuj4sbh9u2eomm1c.jpg" alt=""></p> <blockquote><p>Oh ok, tell me more</p></blockquote> <p>YAML actually stands for &quot;<strong>Y</strong>AML <strong>A</strong>in't <strong>M</strong>arkup <strong>L</strong>anguage&quot; even though it from the beginning stood for <strong>Y</strong>et <strong>A</strong>nother <strong>M</strong>arkup <strong>L</strong>anguage. The reason for changing its meaning was to make clear its purpose as data-oriented, rather than document markup.</p> <p>Yep, you got it, it's a recursive definition. It's also called a <em>human-readable data serialization language</em>.</p> <blockquote><p>Thanks for the history lesson, what about its role in Kubernetes?</p></blockquote> <p>As we said before we've been showing you Kubernetes usage by using the command line and that ain't quite how people use it.</p> <blockquote><p>Let me guess I use YAML files</p></blockquote> <p>Right, every single thing you can describe and deploy to Kubernetes can be described as a YAML file. It's actually simpler that way as well. But before we talk about specific Kubernetes usage we need to know some basics about the YAML files, so to understand the file when we are looking at it</p> <blockquote><p>I'm gonna need coffee for this right?</p></blockquote> <h2 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h2> <p>This article isn't really part of a series but I have written other parts on it. If you are completely new I recommend reading part I first below</p> <ul><li><p><a href="https://dev.to/azure/kubernetes-from-the-beginning-part-i-4ifd" target="_blank" rel="noopener noreferrer">Part I - from the beginning, Part I, Basics, Deployment and Minikube<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
In this part, we cover why Kubernetes, some history and some basic concepts like deploying, Nodes, Pods.</p></li> <li><p><a href="https://dev.to/azure/kubernetes-part-ii-revisiting-pods-and-nodes-and-introducing-services-and-labeling-5fi7" target="_blank" rel="noopener noreferrer">Part II - introducing Services and Labeling<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
In this part, we deepen our knowledge on Pods and Nodes. We also introduce Services and labeling using labels to query our artifacts.</p></li> <li><p><a href="https://dev.to/azure/kubernetes-part-iii-scaling-1mmi" target="_blank" rel="noopener noreferrer">Part III - Scaling<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
In this part, we look at scaling using <em>desired</em> state. We specify how many Pods we want and let Kubernetes do the heavy lifting in terms of ensuring that your Pods are scaled up to the desired number but also maintaining it by using something called self-healing.</p></li> <li><p><a href="https://dev.to/azure/kubernetes-from-the-beginning-part-iv-autoscaling-54l6" target="_blank" rel="noopener noreferrer">Part IV - Auto scaling<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
This is how you likely will carry out scaling in Kubernetes by looking at CPU usage</p></li></ul> <p>Below is some more resource that I recommend you have a look at when Kubernetes is starting to click:</p> <ul><li><a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/" target="_blank" rel="noopener noreferrer">Horizontal Pod Auto scale<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> This describes in detail how everything works. On a flow as well as API level</li> <li><a href="https://azure.microsoft.com/en-gb/free/?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Free Azure Account<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> If you want to try out AKS, Azure Kubernetes Service, you will need a free Azure account</li> <li><a href="https://kubernetes.io" target="_blank" rel="noopener noreferrer">Kubernetes.io<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
One of the best resources to learn about Kubernetes is at this official Kubernetes site by Google.</li> <li><a href="https://azure.microsoft.com/en-gb/topic/kubernetes/?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Kubernetes overview<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> An overview of Kubernetes, all its parts and how it works</li> <li><a href="https://azure.microsoft.com/en-gb/services/kubernetes-service/?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Kubernetes in the Cloud<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> Do you feel you know everything about Kubernetes already and just want to learn how to use a managed service? Then this link is for you</li> <li><a href="https://docs.microsoft.com/en-gb/azure/aks/?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Documentation on AKS, Azure Kubernetes Service<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Azure Kubernetes Service, a managed Kubernetes</li> <li><a href="https://docs.microsoft.com/en-us/azure/aks/best-practices?wt.mc_id=academic-0000-chnoring" target="_blank" rel="noopener noreferrer">Best practices on AKS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> You already know AKS and want to learn how to use it better?</li></ul> <h2 id="the-yaml-format"><a href="#the-yaml-format" aria-hidden="true" class="header-anchor">#</a> The YAML format</h2> <p>What do we need to know about the format to be able to work with it? Well, YAML is a superset of JSON which makes a JSON file a valid YAML file. That's an interesting piece of information but really want to know is the structures used within namely:</p> <ul><li>Maps</li> <li>Lists</li></ul> <blockquote><p>Ok, show me</p></blockquote> <h3 id="maps"><a href="#maps" aria-hidden="true" class="header-anchor">#</a> Maps</h3> <p>Let's start with creating a file, let's call it <code>config.yaml</code>:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">---</span> 
<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> some value
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>This above right here contains some useful insights on the YAML format. The <code>---</code> is called a separator and is optional unless we have more than one structure in the file. What we see after that is <code>version</code> and <code>name</code>. The key is separated by its value with <code>:</code>.</p> <blockquote><p>This is supposed to be a superset of JSON right, aren't we missing double quotations?</p></blockquote> <p>Ah, sharp eyes, double quotations <code>&quot;&quot;</code> are actually optional. Why write more than you have to right? So the above corresponds to the following in JSON:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;some value&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The above is a map, but one of the keys in your Map can point to a map in turn, like the below example:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">---</span> 
<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> some value<span class="token punctuation">,</span>
<span class="token key atrule">address</span><span class="token punctuation">:</span> 
  <span class="token key atrule">street</span><span class="token punctuation">:</span> One Microsoft Way
  <span class="token key atrule">city</span><span class="token punctuation">:</span> Redmond
  <span class="token key atrule">country</span><span class="token punctuation">:</span> USA
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="lists"><a href="#lists" aria-hidden="true" class="header-anchor">#</a> Lists</h3> <p>Ok then, let's look at our next format lists. Consider the following example:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token key atrule">todos</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> shop
 <span class="token punctuation">-</span> clean
 <span class="token punctuation">-</span> do math
 <span class="token punctuation">-</span> write essay
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>todos</code> in this case is the list type and this would correspond to the following in JSON:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;todos&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;shop&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;clean&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;do match&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;write essay&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>What about list items that are maps?</p></blockquote> <p>That's simple:</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">created</span><span class="token punctuation">:</span> <span class="token datetime number">2019-01-01</span>
<span class="token key atrule">items</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> <span class="token key atrule">quantity</span><span class="token punctuation">:</span> <span class="token number">2</span>
   <span class="token key atrule">price</span><span class="token punctuation">:</span> <span class="token number">10</span>
   <span class="token key atrule">discounts</span><span class="token punctuation">:</span>
     <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">1</span>
       <span class="token key atrule">displayName</span><span class="token punctuation">:</span> 10% off  
     <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">111</span>
       <span class="token key atrule">displayName</span><span class="token punctuation">:</span> Holiday Sale
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>The above would correspond to the following JSON:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;created&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019-01-01&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;items&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token property">&quot;quantity&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">111</span><span class="token punctuation">,</span>
    <span class="token property">&quot;discounts&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;displayName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10% off&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">111</span><span class="token punctuation">,</span>
      <span class="token property">&quot;displayName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Holiday Sale&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><blockquote><p>I get it, I think. What about Kubernetes?</p></blockquote> <p>Oh, one more thing before we turn all Kubernetes. Tabs = NOT cool. Spaces are what you use but <em>be consistent</em>, if you start using 2 spaces, usee that throughout.</p> <h2 id="yaml-in-kubernetes"><a href="#yaml-in-kubernetes" aria-hidden="true" class="header-anchor">#</a> YAML In Kubernetes</h2> <p>Most of the things you can deploy to a Cluster in Kubernetes can be described as a YAML file. There are some obvious advantages to that:</p> <ul><li><strong>Saving your fingers</strong>: No more typing long constructs on the command line</li> <li><strong>Source control</strong>: YAML files can be stored in source control and thereby we can track changes</li> <li><strong>Flexibility</strong>: You’ll be able to create much more complex structures using YAML than you can on the command line</li></ul> <p>So what are we going to describe in YAML then? We will not only describe but deploy the following:</p> <ul><li><strong>Pod</strong>, Pod is the smallest possible deployable unit. I know know, you usually don't deploy just a Pod, for the sake of practice lets do it this once</li> <li><strong>Deployment</strong>, this is more on the level of what we would want to deploy. It gives us the ability to defines <em>replicas</em> among other things</li></ul> <h3 id="describe-and-deploy-a-pod"><a href="#describe-and-deploy-a-pod" aria-hidden="true" class="header-anchor">#</a> Describe and deploy a Pod</h3> <p>Lets build up YAML file for a Pod gradually and finish off by deploying to the Cluster. Ok, here we go:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>—<span class="token punctuation">-</span><span class="token punctuation">-</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>We start by specifying an <code>apiVersion</code>. Then we continue with specifying <code>kind: Pod</code>. Now this one is important. This can be many different types like a Deployment or a Service for example, Pod it is.</p> <p><strong>Metadata</strong>
The next part of our file is the metadata part. Here we give it a name and also a label:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">metadata</span><span class="token punctuation">:</span>
 <span class="token key atrule">name</span><span class="token punctuation">:</span> My Pod
 <span class="token key atrule">labels</span><span class="token punctuation">:</span>
   <span class="token key atrule">app</span><span class="token punctuation">:</span> web
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Specification</strong></p> <p>Now we come to the part where we describe the parts that make up the Pod.</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>app
      <span class="token key atrule">image</span><span class="token punctuation">:</span> gcr.io/google<span class="token punctuation">-</span>samples/kubernetes<span class="token punctuation">-</span>bootcamp<span class="token punctuation">:</span>v1
      <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>All put together our <code>pod.yaml</code> file should now look like this:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
 <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>pod
 <span class="token key atrule">labels</span><span class="token punctuation">:</span>
   <span class="token key atrule">app</span><span class="token punctuation">:</span> web
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> first<span class="token punctuation">-</span>app
      <span class="token key atrule">image</span><span class="token punctuation">:</span> gcr.io/google<span class="token punctuation">-</span>samples/kubernetes<span class="token punctuation">-</span>bootcamp<span class="token punctuation">:</span>v1
      <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="deploying-our-pod-yaml"><a href="#deploying-our-pod-yaml" aria-hidden="true" class="header-anchor">#</a> Deploying our POD YAML</h3> <p>At this point we want to deploy it to a cluster. So we will talk to our old friend again, <code>minikube</code> and <code>kubectl</code>.</p> <p>Sometimes my <code>minikube</code> is a bit slow so I restart it with the command <code>minikube start</code>. Once that command has finished running let's check the pod situation with:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl get pods
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>It should list all the Pods that are currently up and running:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/5y2719fm1ca6y1q7b1uv.png" alt=""></p> <p>As you can see above we have done a fair bit of experimenting in the past and created all sorts of Pods, this will obviously look different for you.</p> <p>Thereafter let's take our <code>pod.yaml</code> file and create a Pod from it. To do that we run the command:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl create -f pod.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Which simply means create a Pod from a file <code>-f</code>, with file name <code>pod.yaml</code>. The result of this command is:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/fmwzj23hbfjk8hifhzxg.png" alt=""></p> <p>The result of the command implies we got a Pod created, let's rerun our pods listing command:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl get pods
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://thepracticaldev.s3.amazonaws.com/i/wmyzv2sjt7i32l6ul5yf.png" alt=""></p> <p>This time around our new Pod is up and running. But of course, deploying just a Pod like this is no good. The reason is that Pods are mortal, if it goes down, its gone. No service will bring it up again.</p> <blockquote><p>So why even show it?</p></blockquote> <p>It might be educational to show how you can create an artifact from a file but from a Kubernetes standpoint, it's not using all the wonderful services that could keep it alive if something happens. After all, that's why we have Kubernetes, for the resilience.</p> <p>Therefore, let's look at a deployment next.</p> <p>Before we continue let's clean up after ourselves with:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl delete pods my-pod
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This trigger something called a <em>graceful</em> termination, which is the recommended way of doing things. If you are impatient though you can <em>force delete</em> it with the following command:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl delete pods my-pod --grace-period=0 --force
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>We of course delete the <em>graceful</em> way so after a while we get this:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/uyqfkrhfq77dnux662mc.png" alt=""></p> <p>Were you to run <code>kubectl get pods</code> our pod is now gone. All our app data, gone, vamose.</p> <blockquote><p>I get it, take it easy, I won't create Pods directly, can we continue?</p></blockquote> <h3 id="deployment"><a href="#deployment" aria-hidden="true" class="header-anchor">#</a> Deployment</h3> <p>Ok then, deployments, the right way of doing things.</p> <p>We will use something called a <code>ReplicationController</code>. Now, this is technically an older concept that is gradually being replaced by <code>Deployment</code>s which are a high-level concept managing the deployment of <code>ReplicaSets</code>. There are issues on dashboard support and other things still, which makes all these similar concepts hang around to confuse us a bit more 😉 Bottom line is its ok to use these older concepts for still some time.</p> <p>This time around we will define a new type of object, a so-called <code>ReplicationController</code>. Now, this is a deployment that not only points out what image to deploy to a Pod but also how many Pods we want any given point, a so-called <em>desired state</em>. Let's have a look at the file, starting from the top:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ReplicationController
<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>rc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>We define the <code>kind</code> as of type <code>ReplicationController</code> instead of <code>Pod</code> and we go on to name it in the metadata as <code>my-rc</code>. Now let's head down to the specification part:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">5</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span> 
    <span class="token key atrule">app</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>first<span class="token punctuation">-</span>app
        <span class="token key atrule">image</span><span class="token punctuation">:</span> gcr.io/google<span class="token punctuation">-</span>samples/kubernetes<span class="token punctuation">-</span>bootcamp<span class="token punctuation">:</span>v1
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>The really interesting part here is <code>replicas</code>, the number of Pods and the rest of it is mainly us pointing out the same image again.</p> <p>The specification looks slightly different at the top level, as it is a ReplicationController but the inner <code>spec</code> is what we are used to, pointing out the image, port and other things. Let's see the full file that we name <code>rc.yaml</code>:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ReplicationController
<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>rc
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">5</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span> 
    <span class="token key atrule">app</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> hello<span class="token punctuation">-</span>world
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> my<span class="token punctuation">-</span>first<span class="token punctuation">-</span>app
        <span class="token key atrule">image</span><span class="token punctuation">:</span> gcr.io/google<span class="token punctuation">-</span>samples/kubernetes<span class="token punctuation">-</span>bootcamp<span class="token punctuation">:</span>v1
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>We create the above deployment based on the file by typing:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl create -f rc.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://thepracticaldev.s3.amazonaws.com/i/njz9cljlm2z5ff9bezr7.png" alt=""></p> <p>Above we see that our replication controller is created.</p> <p>Lets list all our pods right now and make sure we get as many pods as expected:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl get pods
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://thepracticaldev.s3.amazonaws.com/i/arw9v572xiwtf2rw7u8q.png" alt=""></p> <p>Looking at the above listing we see that we have 5 replicas, 5 instances of our Pod. We could try and delete one and see what happens:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl delete pods my-rc-wx6h7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>It tells us the above Pod is deleted so we wait for the <em>graceful</em> deletion to finish and then we list our Pods again and this is what we get:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/co75bqrdimib6rxr3nic.png" alt=""></p> <p>As you can see above, our specific Pod is deleted but it's being replaced by another one, the number of replicas is intact, Kubernetes is doing its job</p> <blockquote><p>So how do we bring it down, garlic, a stake?</p></blockquote> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/ri61sug1nj24zauf9g8b.gif" alt=""></p> <p>Let's start by listing all replication controllers:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubernetes get replicationcontroller
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://thepracticaldev.s3.amazonaws.com/i/2c9yjfyityk9v4bnsdov.png" alt=""></p> <p>Now there are two way we can bring it down, garlic or deletion 😉</p> <blockquote><p>Yea yea very funny, deletion, tell me more <em>bored</em></p></blockquote> <p>It's as simple as typing</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl delete replicationcontroller [name of replication controller]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>What happens if you do the above is that it will not only delete the replication controller but the all the pods with it, so-called cascading delete. If you just want the replication controller gone you can specify <code>--cascade=false</code>. We want it all gone so we just type:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl delete my-rc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>That should remove all of it. If we run <code>kubectl get replicationcontroller</code> it should be gone. Let's run <code>kubectl get pods</code> and make sure the pods are gone too.</p> <p>Let's take away the other replication controller as well, it's been hanging around my system for far too long:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl delete replicationcontroller my-rc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Quickly hit:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl get pods
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>and you will be able to see the Pods being terminated:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/43bpff6te1w67zo1hr9y.png" alt=""></p> <h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>In this article, we talked about the file format YAML, what it is, how it works. We also discussed how we should be using YAML files to configure our Kubernetes experience. Furthermore, we showed how to deploy Pods but also <code>ReplicationControllers</code>. Hopefully, this was educational and gave you a taste on what real Kubernetes management looks like.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.95c997f3.js" defer></script><script src="/assets/js/9.454b5262.js" defer></script><script src="/assets/js/4.eac68367.js" defer></script><script src="/assets/js/186.e17f8c1c.js" defer></script>
  </body>
</html>
